<!DOCTYPE html>
<html>
    <head>
        <title>Breakout^4!</title>
        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1" />
    </head>
    <body>
        <canvas width="1020" height="620"></canvas>
        <canvas width="1020" height="620"></canvas>
    </body>
    <script type="text/javascript" src="jquery.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript" src="intersection.js"></script>
    <script>
        function guidGenerator() {
            var S4 = function() {
                return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
            };
            return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
        }
        var clientID = guidGenerator(),
             allCanvas = document.getElementsByTagName('canvas'),
             width = canvas.width,
             height = canvas.height,
             ctx = [allCanvas[0].getContext('2d'), allCanvas[1].getContext('2d')],
             currentCanvas = 0,
             server = window.now || {};

        try {
            var socket = io.connect('http://localhost');
            socket.on('data', function (data) {
                window.Recieve(data);
            });
        }
        catch (ex) {
            //server not running
            alert('Do not run this page without a server!');
        }
        socket.emit('join', {
            id: clientID,
        });
        window.broadcast = function(data) {
            if (window.socket) {
                socket.emit('data', {
                    id: clientID,
                    msg: data
                });
            }
        }
        $(document.body).on('keydown', function(e) {
            switch (e.which) {
                case 37:
                    window.KeyPress('left');
                    break;
                case 39:
                    window.KeyPress('right');
                    break;
                case 38:
                    window.KeyPress('up');
                    break;
                case 40:
                    window.KeyPress('down');
                    break;
                default:
                    window.KeyPress(String.fromCharCode(e.which).toLowerCase());
                    break;
            }
        });
    </script>
    <script type="text/javascript" src="client.js"></script>
</html>

